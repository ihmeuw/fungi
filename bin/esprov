#!/usr/bin/env python
# -*- coding: utf-8 -*-
""" Executable for working with provenance-oriented data in Elasticsearch. """

from elasticsearch import Elasticsearch

from cli import CLIFactory
from esprov import HOST, PORT

__author__ = "Vince Reuter"
__modified__ = "2016-11-07"
__credits__ = ["Vince Reuter"]
__maintainer__ = "Vince Reuter"
__email__ = "vr24@uw.edu"


if __name__ == "__main__":
    """ Command should be of the form: esprov <operation> <type> <query> """

    parser = CLIFactory.get_parser()
    args = parser.parse_args()

    # TODO: handle host configurability.

    es_client = Elasticsearch(hosts=[{"host": HOST, "port": PORT}])
    result = args.func(es_client, args)

    for hit in result:
        print(hit)
